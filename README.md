# Логистический Бот - Техническое Описание Проекта

## Обзор Проекта

Telegram-бот для соединения заказчиков грузоперевозок с водителями, решающий проблему хаоса в существующих логистических группах через автоматический мэтчинг пользователей и встроенную систему платежей.

## Функциональная Архитектура

### Регистрация Пользователей

**Процесс Onboarding:**
1. Пользователь нажимает `/start`
2. Выбор языка интерфейса
3. Заполнение регистрационной анкеты:
   - Имя и фамилия
   - Год рождения
   - Паспортные данные (опционально, для повышения доверия)
   - Роль: **Водитель** или **Посредник (Заказчик)**
   - Для водителей: модель автомобиля и категория транспорта
   - Номер телефона для связи

**Типы Пользователей:**
- **Заказчики (Посредники)** - создают заявки на перевозку грузов
- **Водители** - выполняют доставку грузов по заявкам

### Создание и Управление Грузами

**Форма Создания Груза:**
```
- Откуда: [локация погрузки] (обязательно)
- Куда: [локация разгрузки] (опционально)
- Дата выгрузки: [дата/время] (опционально, по умолчанию - ежедневный поток)
- Цена за груз: [сумма] (для заказчиков)
- Описание груза: [детали]
- Контактный номер: [телефон]
```

**Автоматическая Публикация:**
- Бот автоматически публикует заявку в связанную Telegram-группу
- Включает контактные данные для прямой связи
- Прикрепляет кнопку "Забронировать заказ" для быстрого отклика

### Алгоритм Мэтчинга

**Критерии Подбора:**
1. **Географическая близость** - точка "Откуда" должна максимально соответствовать локации водителя
2. **Совместимость маршрутов** - направление движения водителя
3. **Рейтинг и репутация** - история успешных сделок
4. **Доступность** - текущий статус водителя

**Результат Мэтчинга:**
- Система показывает топ-5 или топ-10 лучших совпадений
- Ранжирование по релевантности и рейтингу
- Возможность связаться напрямую через бота

### Система Ограничений

**Контроль Активных Заказов:**
- **Начальный этап**: водитель может принять только 1 активный заказ
- **Расширенный режим**: до 5 активных грузов для опытных пользователей
- **Запланированные заказы**: возможность бронирования будущих перевозок

**Предотвращение Мошенничества:**
- Ограничение одновременных заказов снижает риски
- Система отзывов и рейтингов после каждой сделки
- Возможность жалоб и блокировки недобросовестных пользователей

### Жизненный Цикл Сделки

**1. Создание Заявки**
```
Заказчик → Заполнение формы → Публикация → Ожидание откликов
```

**2. Поиск Исполнителя**
```
Мэтчинг → Показ вариантов → Выбор водителя → Связь
```

**3. Выполнение Заказа**
```
Договоренности → Забор груза → Доставка → Подтверждение
```

**4. Закрытие Сделки**
```
Кнопка "Закрыть сделку" → Взаимные отзывы → Завершение
```

**Автоматические Напоминания:**
- Если сделка не закрыта, бот отправляет напоминания: "Получилась ли сделка?"
- Периодические уведомления до получения статуса завершения

## Техническая Архитектура

### Технологический Стек
```
├── Backend Framework
│   ├── Node.js (Runtime Environment)
│   ├── GrammyJS (Telegram Bot Framework)
│   └── Express.js (Web Server)
├── Базы Данных
│   ├── MongoDB (Основное хранилище)
│   └── Redis (Кэш и сессии)
├── Внешние API
│   ├── Beepul API (Платежная система)
│   ├── Telegram Bot API
│   └── Geocoding API (Обработка локаций)
└── Инфраструктура
    ├── Docker & Docker Compose
    └── Развертывание на личном сервере
```

### Структура Данных

**Коллекция Пользователей**
```javascript
{
  telegramId: Number,
  profile: {
    firstName: String,
    lastName: String,
    birthYear: Number,
    passportData: String, // опционально
    phoneNumber: String,
    role: String // 'driver' | 'client'
  },
  driverInfo: {
    vehicleModel: String,
    vehicleCategory: String,
    preferredRoutes: Array
  },
  reputation: {
    rating: Number,
    completedDeals: Number,
    reviews: Array
  },
  activeOrders: Number,
  maxOrders: Number // 1 для новичков, до 5 для опытных
}
```

**Коллекция Заказов**
```javascript
{
  clientId: ObjectId,
  driverId: ObjectId, // null до назначения
  cargo: {
    from: String,
    to: String,
    fromCoordinates: Object,
    toCoordinates: Object,
    scheduledDate: Date,
    description: String,
    price: Number
  },
  status: String, // 'active' | 'matched' | 'in_progress' | 'completed'
  publishedToGroup: Boolean,
  autoReminders: Array,
  createdAt: Date
}
```

### Система Платежей

**Интеграция с Beepul:**
- Встроенные платежи через Telegram Bot API
- Эскроу-механизм для безопасности транзакций
- Поддержка международных переводов
- Автоматическое удержание и освобождение средств

**Модель Монетизации:**
1. **Бесплатный период** - первоначальное привлечение пользователей
2. **Подписочная модель** - месячная подписка (~12,000 сум)
3. **Низкий порог входа** - символическая стоимость для массового использования

### Система Уведомлений

**Типы Уведомлений:**
- Новые подходящие заказы для водителей
- Отклики на заявки для заказчиков
- Напоминания о незакрытых сделках
- Запросы на оценку после завершения

**Каналы Доставки:**
- Telegram Bot сообщения
- Push-уведомления (планируется)
- Email-рассылка (опционально)

## Продвижение и Маркетинг

### Стратегия Привлечения Пользователей

**Telegram-маркетинг:**
- Размещение ссылок в логистических чатах и каналах
- Партнерство с существующими группами перевозчиков
- Сотрудничество со школами логистики

**Рекламные Кампании:**
- Таргетированная реклама в Telegram
- Сарафанное радио через раннюю пользовательскую базу
- Рассылки активным пользователям платформы

### Развитие Сообщества

**Геймификация:**
- Система рейтингов и лидерборды
- Бейджи за успешные сделки
- Бонусы для активных пользователей
- Программа лояльности для водителей

## Безопасность и Доверие

### Верификация Пользователей

**Многоуровневая Проверка:**
- Телефонная верификация через Telegram
- Опциональная паспортная идентификация
- Система отзывов и рейтингов
- Возможность жалоб и модерации

**Ответственность Сторон:**
- Заказчик отвечает за проверку легитимности водителя
- Водитель отвечает за проверку заказчика
- Платформа выступает гарантом успешности сделки

### Предотвращение Мошенничества

**Контрольные Механизмы:**
- Ограничение активных заказов (1-2 максимум)
- Обязательные отзывы после каждой сделки
- Система жалоб и блокировок
- Мониторинг подозрительной активности

## Будущее Развитие

### Дополнительные Функции

**Web/Mini App:**
- Расширенная аналитика для пользователей
- Детальная история сделок
- Продвинутые фильтры поиска
- Интеграция с внешними сервисами

**Мобильное Приложение:**
- GPS-трекинг доставок
- Push-уведомления
- Офлайн-режим просмотра заказов
- Интеграция с картами и навигацией

### Масштабирование

**Расширение Функционала:**
- Загрузка фотографий и документов
- Страхование грузов
- Многоязычная поддержка
- Интеграция с логистическими системами

**Географическое Расширение:**
- Поддержка международных перевозок
- Локализация для разных регионов
- Интеграция с местными платежными системами
- Соответствие местному законодательству

Проект представляет собой комплексное решение для цифровизации логистических процессов с акцентом на пользовательский опыт, безопасность сделок и простоту использования в экосистеме Telegram.